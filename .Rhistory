install.packages("BiocManager")
library(BiocManager)
BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
query <- GDCquery(
project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "HTSeq - Counts",
sample.type = c("Primary Tumor", "Solid Tissue Normal")
)
query <- GDCquery(
project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "HTSeq - Counts",
sample.type = c("Primary Tumor", "Solid Tissue Normal")
)
query <- GDCquery(
project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts",
sample.type = c("Primary Tumor", "Solid Tissue Normal")
)
query
GDCdownload(query)
query_small <- GDCquery(
project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts",
sample.type = c("Primary Tumor", "Solid Tissue Normal"),
sample.size = 20
)
query <- GDCquery(
project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts",
sample.type = c("Primary Tumor", "Solid Tissue Normal")
)
query
query_small <- query
query_small$results[[1]] <- query$results[[1]][1:20, ]
query_small
GDCdownload(query_small, method = "api")
brca_data <- GDCprepare(query_small)
brca_data
counts <- assay(brca_data)
library(SummarizedExperiment)
counts <- assay(brca_data)
dim(counts)
counts[1:5, 1:5]
metadata <- colData(brca_data)
head(metadata)
metadata$condition <- ifelse(
metadata$sample_type == "Primary Tumor",
"Tumor",
"Normal"
)
table(metadata$condition)
write.csv(counts, "data/raw_counts_matrix.csv")
getwd()
setwd("~/Desktop/brca_rnaseq _pipeline")
write.csv(counts, "data/raw_counts_matrix.csv")
write.csv(as.data.frame(metadata), "data/sample_metadata.csv")
